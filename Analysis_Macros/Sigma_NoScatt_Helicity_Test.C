#include "./includes_Sigma_NoScatt.h"

// define a legendre polynomial, 6 parameters. Need to set limits?
Double_t legendre(Double_t *x,Double_t *par)
{
    Double_t fitval = 0;
    fitval = (1-TMath::Power(x[0],2)*(par[0]*3+par[1]*15*x[0]+par[2]*15.0/2*(7*TMath::Power(x[0],2)-1)+par[3]*105.0/2*x[0]*(3*TMath::Power(x[0],2)-1)+par[4]*105.0/8*(8*TMath::Power(x[0],4)-18*TMath::Power(x[0],2)+1)+par[5]*63.0/8*x*(143*TMath::Power(x[0],4)-110*TMath::Power(x[0],2)+15)+par[6]*315.0/16*(143*TMath::Power(x[0],6)-143*TMath::Power(x[0],4)+8*TMath::Power(x[0],2)-1)));
    return fitval;
}

void Sigma_NoScatt_Helicity_Test(){

    TFile *MBData = TFile::Open("/scratch/Mainz_Software/a2GoAT/Sig_res_St.root");

    TFile *f1= TFile::Open("/scratch/Mainz_Software/a2GoAT/ParaPerpAsymm_NoScatt_Total_10.root");
    TTree *t1 = (TTree*)f1->Get("Parameter_Values");
    TF1 *LegendreFunc = new TF1("LegendreFit",  legendre, -1, 1, 7); //Give a name and range to the fitting funcion

    Double_t pValues425NegHel[10], pValues435NegHel[10], pValues445NegHel[10], pValues455NegHel[10], pValues465NegHel[10], pValues475NegHel[10], pValues485NegHel[10], pValues495NegHel[10], pValues505NegHel[10], pValues515NegHel[10], pValues525NegHel[10], pValues535NegHel[10], pValues545NegHel[10], pValues555NegHel[10], pValues565NegHel[10], pValues575NegHel[10], pValues585NegHel[10], pValues595NegHel[10], pValues605NegHel[10], pValues615NegHel[10];
    Double_t pErrValues425NegHel[10], pErrValues435NegHel[10], pErrValues445NegHel[10], pErrValues455NegHel[10], pErrValues465NegHel[10], pErrValues475NegHel[10], pErrValues485NegHel[10], pErrValues495NegHel[10], pErrValues505NegHel[10], pErrValues515NegHel[10], pErrValues525NegHel[10], pErrValues535NegHel[10], pErrValues545NegHel[10], pErrValues555NegHel[10], pErrValues565NegHel[10], pErrValues575NegHel[10], pErrValues585NegHel[10], pErrValues595NegHel[10], pErrValues605NegHel[10], pErrValues615NegHel[10];
    Double_t pSigmaValues425NegHel[10], pSigmaValues435NegHel[10], pSigmaValues445NegHel[10], pSigmaValues455NegHel[10], pSigmaValues465NegHel[10], pSigmaValues475NegHel[10], pSigmaValues485NegHel[10], pSigmaValues495NegHel[10], pSigmaValues505NegHel[10], pSigmaValues515NegHel[10], pSigmaValues525NegHel[10], pSigmaValues535NegHel[10], pSigmaValues545NegHel[10], pSigmaValues555NegHel[10], pSigmaValues565NegHel[10], pSigmaValues575NegHel[10], pSigmaValues585NegHel[10], pSigmaValues595NegHel[10], pSigmaValues605NegHel[10], pSigmaValues615NegHel[10];
    Double_t pSigmaErrValues425NegHel[10], pSigmaErrValues435NegHel[10], pSigmaErrValues445NegHel[10], pSigmaErrValues455NegHel[10], pSigmaErrValues465NegHel[10], pSigmaErrValues475NegHel[10], pSigmaErrValues485NegHel[10], pSigmaErrValues495NegHel[10], pSigmaErrValues505NegHel[10], pSigmaErrValues515NegHel[10], pSigmaErrValues525NegHel[10], pSigmaErrValues535NegHel[10], pSigmaErrValues545NegHel[10], pSigmaErrValues555NegHel[10], pSigmaErrValues565NegHel[10], pSigmaErrValues575NegHel[10], pSigmaErrValues585NegHel[10], pSigmaErrValues595NegHel[10], pSigmaErrValues605NegHel[10], pSigmaErrValues615NegHel[10];
    Double_t pValues425PosHel[10], pValues435PosHel[10], pValues445PosHel[10], pValues455PosHel[10], pValues465PosHel[10], pValues475PosHel[10], pValues485PosHel[10], pValues495PosHel[10], pValues505PosHel[10], pValues515PosHel[10], pValues525PosHel[10], pValues535PosHel[10], pValues545PosHel[10], pValues555PosHel[10], pValues565PosHel[10], pValues575PosHel[10], pValues585PosHel[10], pValues595PosHel[10], pValues605PosHel[10], pValues615PosHel[10];
    Double_t pErrValues425PosHel[10], pErrValues435PosHel[10], pErrValues445PosHel[10], pErrValues455PosHel[10], pErrValues465PosHel[10], pErrValues475PosHel[10], pErrValues485PosHel[10], pErrValues495PosHel[10], pErrValues505PosHel[10], pErrValues515PosHel[10], pErrValues525PosHel[10], pErrValues535PosHel[10], pErrValues545PosHel[10], pErrValues555PosHel[10], pErrValues565PosHel[10], pErrValues575PosHel[10], pErrValues585PosHel[10], pErrValues595PosHel[10], pErrValues605PosHel[10], pErrValues615PosHel[10];
    Double_t pSigmaValues425PosHel[10], pSigmaValues435PosHel[10], pSigmaValues445PosHel[10], pSigmaValues455PosHel[10], pSigmaValues465PosHel[10], pSigmaValues475PosHel[10], pSigmaValues485PosHel[10], pSigmaValues495PosHel[10], pSigmaValues505PosHel[10], pSigmaValues515PosHel[10], pSigmaValues525PosHel[10], pSigmaValues535PosHel[10], pSigmaValues545PosHel[10], pSigmaValues555PosHel[10], pSigmaValues565PosHel[10], pSigmaValues575PosHel[10], pSigmaValues585PosHel[10], pSigmaValues595PosHel[10], pSigmaValues605PosHel[10], pSigmaValues615PosHel[10];
    Double_t pSigmaErrValues425PosHel[10], pSigmaErrValues435PosHel[10], pSigmaErrValues445PosHel[10], pSigmaErrValues455PosHel[10], pSigmaErrValues465PosHel[10], pSigmaErrValues475PosHel[10], pSigmaErrValues485PosHel[10], pSigmaErrValues495PosHel[10], pSigmaErrValues505PosHel[10], pSigmaErrValues515PosHel[10], pSigmaErrValues525PosHel[10], pSigmaErrValues535PosHel[10], pSigmaErrValues545PosHel[10], pSigmaErrValues555PosHel[10], pSigmaErrValues565PosHel[10], pSigmaErrValues575PosHel[10], pSigmaErrValues585PosHel[10], pSigmaErrValues595PosHel[10], pSigmaErrValues605PosHel[10], pSigmaErrValues615PosHel[10];

    Double_t pCosAmp425NegHel, pCosAmpErr425NegHel;
    Double_t pCosAmp435NegHel, pCosAmpErr435NegHel;
    Double_t pCosAmp445NegHel, pCosAmpErr445NegHel;
    Double_t pCosAmp455NegHel, pCosAmpErr455NegHel;
    Double_t pCosAmp465NegHel, pCosAmpErr465NegHel;
    Double_t pCosAmp475NegHel, pCosAmpErr475NegHel;
    Double_t pCosAmp485NegHel, pCosAmpErr485NegHel;
    Double_t pCosAmp495NegHel, pCosAmpErr495NegHel;
    Double_t pCosAmp505NegHel, pCosAmpErr505NegHel;
    Double_t pCosAmp515NegHel, pCosAmpErr515NegHel;
    Double_t pCosAmp525NegHel, pCosAmpErr525NegHel;
    Double_t pCosAmp535NegHel, pCosAmpErr535NegHel;
    Double_t pCosAmp545NegHel, pCosAmpErr545NegHel;
    Double_t pCosAmp555NegHel, pCosAmpErr555NegHel;
    Double_t pCosAmp565NegHel, pCosAmpErr565NegHel;
    Double_t pCosAmp575NegHel, pCosAmpErr575NegHel;
    Double_t pCosAmp585NegHel, pCosAmpErr585NegHel;
    Double_t pCosAmp595NegHel, pCosAmpErr595NegHel;
    Double_t pCosAmp605NegHel, pCosAmpErr605NegHel;
    Double_t pCosAmp615NegHel, pCosAmpErr615NegHel;
    Double_t pCosAmp425PosHel, pCosAmpErr425PosHel;
    Double_t pCosAmp435PosHel, pCosAmpErr435PosHel;
    Double_t pCosAmp445PosHel, pCosAmpErr445PosHel;
    Double_t pCosAmp455PosHel, pCosAmpErr455PosHel;
    Double_t pCosAmp465PosHel, pCosAmpErr465PosHel;
    Double_t pCosAmp475PosHel, pCosAmpErr475PosHel;
    Double_t pCosAmp485PosHel, pCosAmpErr485PosHel;
    Double_t pCosAmp495PosHel, pCosAmpErr495PosHel;
    Double_t pCosAmp505PosHel, pCosAmpErr505PosHel;
    Double_t pCosAmp515PosHel, pCosAmpErr515PosHel;
    Double_t pCosAmp525PosHel, pCosAmpErr525PosHel;
    Double_t pCosAmp535PosHel, pCosAmpErr535PosHel;
    Double_t pCosAmp545PosHel, pCosAmpErr545PosHel;
    Double_t pCosAmp555PosHel, pCosAmpErr555PosHel;
    Double_t pCosAmp565PosHel, pCosAmpErr565PosHel;
    Double_t pCosAmp575PosHel, pCosAmpErr575PosHel;
    Double_t pCosAmp585PosHel, pCosAmpErr585PosHel;
    Double_t pCosAmp595PosHel, pCosAmpErr595PosHel;
    Double_t pCosAmp605PosHel, pCosAmpErr605PosHel;
    Double_t pCosAmp615PosHel, pCosAmpErr615PosHel;

    // Set branch addresses to get values from
    t1->SetBranchAddress("pCosAmp425NegHel", &pCosAmp425NegHel);
    t1->SetBranchAddress("pCosAmpErr425NegHel", &pCosAmpErr425NegHel);
    t1->SetBranchAddress("pCosAmp435NegHel", &pCosAmp435NegHel);
    t1->SetBranchAddress("pCosAmpErr435NegHel", &pCosAmpErr435NegHel);
    t1->SetBranchAddress("pCosAmp445NegHel", &pCosAmp445NegHel);
    t1->SetBranchAddress("pCosAmpErr445NegHel", &pCosAmpErr445NegHel);
    t1->SetBranchAddress("pCosAmp455NegHel", &pCosAmp455NegHel);
    t1->SetBranchAddress("pCosAmpErr455NegHel", &pCosAmpErr455NegHel);
    t1->SetBranchAddress("pCosAmp465NegHel", &pCosAmp465NegHel);
    t1->SetBranchAddress("pCosAmpErr465NegHel", &pCosAmpErr465NegHel);
    t1->SetBranchAddress("pCosAmp475NegHel", &pCosAmp475NegHel);
    t1->SetBranchAddress("pCosAmpErr475NegHel", &pCosAmpErr475NegHel);
    t1->SetBranchAddress("pCosAmp485NegHel", &pCosAmp485NegHel);
    t1->SetBranchAddress("pCosAmpErr485NegHel", &pCosAmpErr485NegHel);
    t1->SetBranchAddress("pCosAmp495NegHel", &pCosAmp495NegHel);
    t1->SetBranchAddress("pCosAmpErr495NegHel", &pCosAmpErr495NegHel);
    t1->SetBranchAddress("pCosAmp505NegHel", &pCosAmp505NegHel);
    t1->SetBranchAddress("pCosAmpErr505NegHel", &pCosAmpErr505NegHel);
    t1->SetBranchAddress("pCosAmp515NegHel", &pCosAmp515NegHel);
    t1->SetBranchAddress("pCosAmpErr515NegHel", &pCosAmpErr515NegHel);
    t1->SetBranchAddress("pCosAmp525NegHel", &pCosAmp525NegHel);
    t1->SetBranchAddress("pCosAmpErr525NegHel", &pCosAmpErr525NegHel);
    t1->SetBranchAddress("pCosAmp535NegHel", &pCosAmp535NegHel);
    t1->SetBranchAddress("pCosAmpErr535NegHel", &pCosAmpErr535NegHel);
    t1->SetBranchAddress("pCosAmp545NegHel", &pCosAmp545NegHel);
    t1->SetBranchAddress("pCosAmpErr545NegHel", &pCosAmpErr545NegHel);
    t1->SetBranchAddress("pCosAmp555NegHel", &pCosAmp555NegHel);
    t1->SetBranchAddress("pCosAmpErr555NegHel", &pCosAmpErr555NegHel);
    t1->SetBranchAddress("pCosAmp565NegHel", &pCosAmp565NegHel);
    t1->SetBranchAddress("pCosAmpErr565NegHel", &pCosAmpErr565NegHel);
    t1->SetBranchAddress("pCosAmp575NegHel", &pCosAmp575NegHel);
    t1->SetBranchAddress("pCosAmpErr575NegHel", &pCosAmpErr575NegHel);
    t1->SetBranchAddress("pCosAmp585NegHel", &pCosAmp585NegHel);
    t1->SetBranchAddress("pCosAmpErr585NegHel", &pCosAmpErr585NegHel);
    t1->SetBranchAddress("pCosAmp595NegHel", &pCosAmp595NegHel);
    t1->SetBranchAddress("pCosAmpErr595NegHel", &pCosAmpErr595NegHel);
    t1->SetBranchAddress("pCosAmp605NegHel", &pCosAmp605NegHel);
    t1->SetBranchAddress("pCosAmpErr605NegHel", &pCosAmpErr605NegHel);
    t1->SetBranchAddress("pCosAmp615NegHel", &pCosAmp615NegHel);
    t1->SetBranchAddress("pCosAmpErr615NegHel", &pCosAmpErr615NegHel);
    t1->SetBranchAddress("pCosAmp425PosHel", &pCosAmp425PosHel);
    t1->SetBranchAddress("pCosAmpErr425PosHel", &pCosAmpErr425PosHel);
    t1->SetBranchAddress("pCosAmp435PosHel", &pCosAmp435PosHel);
    t1->SetBranchAddress("pCosAmpErr435PosHel", &pCosAmpErr435PosHel);
    t1->SetBranchAddress("pCosAmp445PosHel", &pCosAmp445PosHel);
    t1->SetBranchAddress("pCosAmpErr445PosHel", &pCosAmpErr445PosHel);
    t1->SetBranchAddress("pCosAmp455PosHel", &pCosAmp455PosHel);
    t1->SetBranchAddress("pCosAmpErr455PosHel", &pCosAmpErr455PosHel);
    t1->SetBranchAddress("pCosAmp465PosHel", &pCosAmp465PosHel);
    t1->SetBranchAddress("pCosAmpErr465PosHel", &pCosAmpErr465PosHel);
    t1->SetBranchAddress("pCosAmp475PosHel", &pCosAmp475PosHel);
    t1->SetBranchAddress("pCosAmpErr475PosHel", &pCosAmpErr475PosHel);
    t1->SetBranchAddress("pCosAmp485PosHel", &pCosAmp485PosHel);
    t1->SetBranchAddress("pCosAmpErr485PosHel", &pCosAmpErr485PosHel);
    t1->SetBranchAddress("pCosAmp495PosHel", &pCosAmp495PosHel);
    t1->SetBranchAddress("pCosAmpErr495PosHel", &pCosAmpErr495PosHel);
    t1->SetBranchAddress("pCosAmp505PosHel", &pCosAmp505PosHel);
    t1->SetBranchAddress("pCosAmpErr505PosHel", &pCosAmpErr505PosHel);
    t1->SetBranchAddress("pCosAmp515PosHel", &pCosAmp515PosHel);
    t1->SetBranchAddress("pCosAmpErr515PosHel", &pCosAmpErr515PosHel);
    t1->SetBranchAddress("pCosAmp525PosHel", &pCosAmp525PosHel);
    t1->SetBranchAddress("pCosAmpErr525PosHel", &pCosAmpErr525PosHel);
    t1->SetBranchAddress("pCosAmp535PosHel", &pCosAmp535PosHel);
    t1->SetBranchAddress("pCosAmpErr535PosHel", &pCosAmpErr535PosHel);
    t1->SetBranchAddress("pCosAmp545PosHel", &pCosAmp545PosHel);
    t1->SetBranchAddress("pCosAmpErr545PosHel", &pCosAmpErr545PosHel);
    t1->SetBranchAddress("pCosAmp555PosHel", &pCosAmp555PosHel);
    t1->SetBranchAddress("pCosAmpErr555PosHel", &pCosAmpErr555PosHel);
    t1->SetBranchAddress("pCosAmp565PosHel", &pCosAmp565PosHel);
    t1->SetBranchAddress("pCosAmpErr565PosHel", &pCosAmpErr565PosHel);
    t1->SetBranchAddress("pCosAmp575PosHel", &pCosAmp575PosHel);
    t1->SetBranchAddress("pCosAmpErr575PosHel", &pCosAmpErr575PosHel);
    t1->SetBranchAddress("pCosAmp585PosHel", &pCosAmp585PosHel);
    t1->SetBranchAddress("pCosAmpErr585PosHel", &pCosAmpErr585PosHel);
    t1->SetBranchAddress("pCosAmp595PosHel", &pCosAmp595PosHel);
    t1->SetBranchAddress("pCosAmpErr595PosHel", &pCosAmpErr595PosHel);
    t1->SetBranchAddress("pCosAmp605PosHel", &pCosAmp605PosHel);
    t1->SetBranchAddress("pCosAmpErr605PosHel", &pCosAmpErr605PosHel);
    t1->SetBranchAddress("pCosAmp615PosHel", &pCosAmp615PosHel);
    t1->SetBranchAddress("pCosAmpErr615PosHel", &pCosAmpErr615PosHel);

    // Load values from tree and asign values back into an array
    for (Int_t k = 0; k < 10; k++){
        Parameter_Values->GetEntry(k);
        pValues425NegHel[k] = pCosAmp425NegHel;
        pErrValues425NegHel[k] = pCosAmpErr425NegHel;
        pValues435NegHel[k] = pCosAmp435NegHel;
        pErrValues435NegHel[k] = pCosAmpErr435NegHel;
        pValues445NegHel[k] = pCosAmp445NegHel;
        pErrValues445NegHel[k] = pCosAmpErr445NegHel;
        pValues455NegHel[k] = pCosAmp455NegHel;
        pErrValues455NegHel[k] = pCosAmpErr455NegHel;
        pValues465NegHel[k] = pCosAmp465NegHel;
        pErrValues465NegHel[k] = pCosAmpErr465NegHel;
        pValues475NegHel[k] = pCosAmp475NegHel;
        pErrValues475NegHel[k] = pCosAmpErr475NegHel;
        pValues485NegHel[k] = pCosAmp485NegHel;
        pErrValues485NegHel[k] = pCosAmpErr485NegHel;
        pValues495NegHel[k] = pCosAmp495NegHel;
        pErrValues495NegHel[k] = pCosAmpErr495NegHel;
        pValues505NegHel[k] = pCosAmp505NegHel;
        pErrValues505NegHel[k] = pCosAmpErr505NegHel;
        pValues515NegHel[k] = pCosAmp515NegHel;
        pErrValues515NegHel[k] = pCosAmpErr515NegHel;
        pValues525NegHel[k] = pCosAmp525NegHel;
        pErrValues525NegHel[k] = pCosAmpErr525NegHel;
        pValues535NegHel[k] = pCosAmp535NegHel;
        pErrValues535NegHel[k] = pCosAmpErr535NegHel;
        pValues545NegHel[k] = pCosAmp545NegHel;
        pErrValues545NegHel[k] = pCosAmpErr545NegHel;
        pValues555NegHel[k] = pCosAmp555NegHel;
        pErrValues555NegHel[k] = pCosAmpErr555NegHel;
        pValues565NegHel[k] = pCosAmp565NegHel;
        pErrValues565NegHel[k] = pCosAmpErr565NegHel;
        pValues575NegHel[k] = pCosAmp575NegHel;
        pErrValues575NegHel[k] = pCosAmpErr575NegHel;
        pValues585NegHel[k] = pCosAmp585NegHel;
        pErrValues585NegHel[k] = pCosAmpErr585NegHel;
        pValues595NegHel[k] = pCosAmp595NegHel;
        pErrValues595NegHel[k] = pCosAmpErr595NegHel;
        pValues605NegHel[k] = pCosAmp605NegHel;
        pErrValues605NegHel[k] = pCosAmpErr605NegHel;
        pValues615NegHel[k] = pCosAmp615NegHel;
        pErrValues615NegHel[k] = pCosAmpErr615NegHel;
        pValues425PosHel[k] = pCosAmp425PosHel;
        pErrValues425PosHel[k] = pCosAmpErr425PosHel;
        pValues435PosHel[k] = pCosAmp435PosHel;
        pErrValues435PosHel[k] = pCosAmpErr435PosHel;
        pValues445PosHel[k] = pCosAmp445PosHel;
        pErrValues445PosHel[k] = pCosAmpErr445PosHel;
        pValues455PosHel[k] = pCosAmp455PosHel;
        pErrValues455PosHel[k] = pCosAmpErr455PosHel;
        pValues465PosHel[k] = pCosAmp465PosHel;
        pErrValues465PosHel[k] = pCosAmpErr465PosHel;
        pValues475PosHel[k] = pCosAmp475PosHel;
        pErrValues475PosHel[k] = pCosAmpErr475PosHel;
        pValues485PosHel[k] = pCosAmp485PosHel;
        pErrValues485PosHel[k] = pCosAmpErr485PosHel;
        pValues495PosHel[k] = pCosAmp495PosHel;
        pErrValues495PosHel[k] = pCosAmpErr495PosHel;
        pValues505PosHel[k] = pCosAmp505PosHel;
        pErrValues505PosHel[k] = pCosAmpErr505PosHel;
        pValues515PosHel[k] = pCosAmp515PosHel;
        pErrValues515PosHel[k] = pCosAmpErr515PosHel;
        pValues525PosHel[k] = pCosAmp525PosHel;
        pErrValues525PosHel[k] = pCosAmpErr525PosHel;
        pValues535PosHel[k] = pCosAmp535PosHel;
        pErrValues535PosHel[k] = pCosAmpErr535PosHel;
        pValues545PosHel[k] = pCosAmp545PosHel;
        pErrValues545PosHel[k] = pCosAmpErr545PosHel;
        pValues555PosHel[k] = pCosAmp555PosHel;
        pErrValues555PosHel[k] = pCosAmpErr555PosHel;
        pValues565PosHel[k] = pCosAmp565PosHel;
        pErrValues565PosHel[k] = pCosAmpErr565PosHel;
        pValues575PosHel[k] = pCosAmp575PosHel;
        pErrValues575PosHel[k] = pCosAmpErr575PosHel;
        pValues585PosHel[k] = pCosAmp585PosHel;
        pErrValues585PosHel[k] = pCosAmpErr585PosHel;
        pValues595PosHel[k] = pCosAmp595PosHel;
        pErrValues595PosHel[k] = pCosAmpErr595PosHel;
        pValues605PosHel[k] = pCosAmp605PosHel;
        pErrValues605PosHel[k] = pCosAmpErr605PosHel;
        pValues615PosHel[k] = pCosAmp615PosHel;
        pErrValues615PosHel[k] = pCosAmpErr615PosHel;

    }

    TFile *f4 = TFile::Open("/scratch/Mainz_Software/a2GoAT/ParaPerpAsymm_NoScatt_Total_9.root");
    TTree *t2 = (TTree*)f4->Get("Parameter_Values");
    Double_t pValues425[10], pValues435[10], pValues445[10], pValues455[10], pValues465[10], pValues475[10], pValues485[10], pValues495[10], pValues505[10], pValues515[10], pValues525[10], pValues535[10], pValues545[10], pValues555[10], pValues565[10], pValues575[10], pValues585[10], pValues595[10], pValues605[10], pValues615[10];
    Double_t pErrValues425[10], pErrValues435[10], pErrValues445[10], pErrValues455[10], pErrValues465[10], pErrValues475[10], pErrValues485[10], pErrValues495[10], pErrValues505[10], pErrValues515[10], pErrValues525[10], pErrValues535[10], pErrValues545[10], pErrValues555[10], pErrValues565[10], pErrValues575[10], pErrValues585[10], pErrValues595[10], pErrValues605[10], pErrValues615[10];
    Double_t pSigmaValues425[10], pSigmaValues435[10], pSigmaValues445[10], pSigmaValues455[10], pSigmaValues465[10], pSigmaValues475[10], pSigmaValues485[10], pSigmaValues495[10], pSigmaValues505[10], pSigmaValues515[10], pSigmaValues525[10], pSigmaValues535[10], pSigmaValues545[10], pSigmaValues555[10], pSigmaValues565[10], pSigmaValues575[10], pSigmaValues585[10], pSigmaValues595[10], pSigmaValues605[10], pSigmaValues615[10];
    Double_t pSigmaErrValues425[10], pSigmaErrValues435[10], pSigmaErrValues445[10], pSigmaErrValues455[10], pSigmaErrValues465[10], pSigmaErrValues475[10], pSigmaErrValues485[10], pSigmaErrValues495[10], pSigmaErrValues505[10], pSigmaErrValues515[10], pSigmaErrValues525[10], pSigmaErrValues535[10], pSigmaErrValues545[10], pSigmaErrValues555[10], pSigmaErrValues565[10], pSigmaErrValues575[10], pSigmaErrValues585[10], pSigmaErrValues595[10], pSigmaErrValues605[10], pSigmaErrValues615[10];;

    Double_t pCosAmp425, pCosAmpErr425;
    Double_t pCosAmp435, pCosAmpErr435;
    Double_t pCosAmp445, pCosAmpErr445;
    Double_t pCosAmp455, pCosAmpErr455;
    Double_t pCosAmp465, pCosAmpErr465;
    Double_t pCosAmp475, pCosAmpErr475;
    Double_t pCosAmp485, pCosAmpErr485;
    Double_t pCosAmp495, pCosAmpErr495;
    Double_t pCosAmp505, pCosAmpErr505;
    Double_t pCosAmp515, pCosAmpErr515;
    Double_t pCosAmp525, pCosAmpErr525;
    Double_t pCosAmp535, pCosAmpErr535;
    Double_t pCosAmp545, pCosAmpErr545;
    Double_t pCosAmp555, pCosAmpErr555;
    Double_t pCosAmp565, pCosAmpErr565;
    Double_t pCosAmp575, pCosAmpErr575;
    Double_t pCosAmp585, pCosAmpErr585;
    Double_t pCosAmp595, pCosAmpErr595;
    Double_t pCosAmp605, pCosAmpErr605;
    Double_t pCosAmp615, pCosAmpErr615;

    t2->SetBranchAddress("pCosAmp425", &pCosAmp425);
    t2->SetBranchAddress("pCosAmpErr425", &pCosAmpErr425);
    t2->SetBranchAddress("pCosAmp435", &pCosAmp435);
    t2->SetBranchAddress("pCosAmpErr435", &pCosAmpErr435);
    t2->SetBranchAddress("pCosAmp445", &pCosAmp445);
    t2->SetBranchAddress("pCosAmpErr445", &pCosAmpErr445);
    t2->SetBranchAddress("pCosAmp455", &pCosAmp455);
    t2->SetBranchAddress("pCosAmpErr455", &pCosAmpErr455);
    t2->SetBranchAddress("pCosAmp465", &pCosAmp465);
    t2->SetBranchAddress("pCosAmpErr465", &pCosAmpErr465);
    t2->SetBranchAddress("pCosAmp475", &pCosAmp475);
    t2->SetBranchAddress("pCosAmpErr475", &pCosAmpErr475);
    t2->SetBranchAddress("pCosAmp485", &pCosAmp485);
    t2->SetBranchAddress("pCosAmpErr485", &pCosAmpErr485);
    t2->SetBranchAddress("pCosAmp495", &pCosAmp495);
    t2->SetBranchAddress("pCosAmpErr495", &pCosAmpErr495);
    t2->SetBranchAddress("pCosAmp505", &pCosAmp505);
    t2->SetBranchAddress("pCosAmpErr505", &pCosAmpErr505);
    t2->SetBranchAddress("pCosAmp515", &pCosAmp515);
    t2->SetBranchAddress("pCosAmpErr515", &pCosAmpErr515);
    t2->SetBranchAddress("pCosAmp525", &pCosAmp525);
    t2->SetBranchAddress("pCosAmpErr525", &pCosAmpErr525);
    t2->SetBranchAddress("pCosAmp535", &pCosAmp535);
    t2->SetBranchAddress("pCosAmpErr535", &pCosAmpErr535);
    t2->SetBranchAddress("pCosAmp545", &pCosAmp545);
    t2->SetBranchAddress("pCosAmpErr545", &pCosAmpErr545);
    t2->SetBranchAddress("pCosAmp555", &pCosAmp555);
    t2->SetBranchAddress("pCosAmpErr555", &pCosAmpErr555);
    t2->SetBranchAddress("pCosAmp565", &pCosAmp565);
    t2->SetBranchAddress("pCosAmpErr565", &pCosAmpErr565);
    t2->SetBranchAddress("pCosAmp575", &pCosAmp575);
    t2->SetBranchAddress("pCosAmpErr575", &pCosAmpErr575);
    t2->SetBranchAddress("pCosAmp585", &pCosAmp585);
    t2->SetBranchAddress("pCosAmpErr585", &pCosAmpErr585);
    t2->SetBranchAddress("pCosAmp595", &pCosAmp595);
    t2->SetBranchAddress("pCosAmpErr595", &pCosAmpErr595);
    t2->SetBranchAddress("pCosAmp605", &pCosAmp605);
    t2->SetBranchAddress("pCosAmpErr605", &pCosAmpErr605);
    t2->SetBranchAddress("pCosAmp615", &pCosAmp615);
    t2->SetBranchAddress("pCosAmpErr615", &pCosAmpErr615);

    for (Int_t k = 0; k < 10; k++){
        Parameter_Values->GetEntry(k);
        pValues425[k] = pCosAmp425;
        pErrValues425[k] = pCosAmpErr425;
        pValues435[k] = pCosAmp435;
        pErrValues435[k] = pCosAmpErr435;
        pValues445[k] = pCosAmp445;
        pErrValues445[k] = pCosAmpErr445;
        pValues455[k] = pCosAmp455;
        pErrValues455[k] = pCosAmpErr455;
        pValues465[k] = pCosAmp465;
        pErrValues465[k] = pCosAmpErr465;
        pValues475[k] = pCosAmp475;
        pErrValues475[k] = pCosAmpErr475;
        pValues485[k] = pCosAmp485;
        pErrValues485[k] = pCosAmpErr485;
        pValues495[k] = pCosAmp495;
        pErrValues495[k] = pCosAmpErr495;
        pValues505[k] = pCosAmp505;
        pErrValues505[k] = pCosAmpErr505;
        pValues515[k] = pCosAmp515;
        pErrValues515[k] = pCosAmpErr515;
        pValues525[k] = pCosAmp525;
        pErrValues525[k] = pCosAmpErr525;
        pValues535[k] = pCosAmp535;
        pErrValues535[k] = pCosAmpErr535;
        pValues545[k] = pCosAmp545;
        pErrValues545[k] = pCosAmpErr545;
        pValues555[k] = pCosAmp555;
        pErrValues555[k] = pCosAmpErr555;
        pValues565[k] = pCosAmp565;
        pErrValues565[k] = pCosAmpErr565;
        pValues575[k] = pCosAmp575;
        pErrValues575[k] = pCosAmpErr575;
        pValues585[k] = pCosAmp585;
        pErrValues585[k] = pCosAmpErr585;
        pValues595[k] = pCosAmp595;
        pErrValues595[k] = pCosAmpErr595;
        pValues605[k] = pCosAmp605;
        pErrValues605[k] = pCosAmpErr605;
        pValues615[k] = pCosAmp615;
        pErrValues615[k] = pCosAmpErr615;

    }


    TFile *f2= TFile::Open("/scratch/Mainz_Software/a2GoAT/LinPol_Aug16.root"); // Open linear polarisation plot

    // Calculate values of sigma for each angular and energy bin
    for (Int_t i = 0; i < 10; i++){

        pSigmaValues425[i] = pValues425[i]/(Graph->Eval(425,0));
        pSigmaErrValues425[i] = pErrValues425[i]/(Graph->Eval(425,0));
        pSigmaValues435[i] = pValues435[i]/(Graph->Eval(435,0));
        pSigmaErrValues435[i] = pErrValues435[i]/(Graph->Eval(435,0));
        pSigmaValues445[i] = pValues445[i]/(Graph->Eval(445,0));
        pSigmaErrValues445[i] = pErrValues445[i]/(Graph->Eval(445,0));
        pSigmaValues455[i] = pValues455[i]/(Graph->Eval(455,0));
        pSigmaErrValues455[i] = pErrValues455[i]/(Graph->Eval(455,0));
        pSigmaValues465[i] = pValues465[i]/(Graph->Eval(465,0));
        pSigmaErrValues465[i] = pErrValues465[i]/(Graph->Eval(465,0));
        pSigmaValues475[i] = pValues475[i]/(Graph->Eval(475,0));
        pSigmaErrValues475[i] = pErrValues475[i]/(Graph->Eval(475,0));
        pSigmaValues485[i] = pValues485[i]/(Graph->Eval(485,0));
        pSigmaErrValues485[i] = pErrValues485[i]/(Graph->Eval(485,0));
        pSigmaValues495[i] = pValues495[i]/(Graph->Eval(495,0));
        pSigmaErrValues495[i] = pErrValues495[i]/(Graph->Eval(495,0));
        pSigmaValues505[i] = pValues505[i]/(Graph->Eval(505,0));
        pSigmaErrValues505[i] = pErrValues505[i]/(Graph->Eval(505,0));
        pSigmaValues515[i] = pValues515[i]/(Graph->Eval(515,0));
        pSigmaErrValues515[i] = pErrValues515[i]/(Graph->Eval(515,0));
        pSigmaValues525[i] = pValues525[i]/(Graph->Eval(525,0));
        pSigmaErrValues525[i] = pErrValues525[i]/(Graph->Eval(525,0));
        pSigmaValues535[i] = pValues535[i]/(Graph->Eval(535,0));
        pSigmaErrValues535[i] = pErrValues535[i]/(Graph->Eval(535,0));
        pSigmaValues545[i] = pValues545[i]/(Graph->Eval(545,0));
        pSigmaErrValues545[i] = pErrValues545[i]/(Graph->Eval(545,0));
        pSigmaValues555[i] = pValues555[i]/(Graph->Eval(555,0));
        pSigmaErrValues555[i] = pErrValues555[i]/(Graph->Eval(555,0));
        pSigmaValues565[i] = pValues565[i]/(Graph->Eval(565,0));
        pSigmaErrValues565[i] = pErrValues565[i]/(Graph->Eval(565,0));
        pSigmaValues575[i] = pValues575[i]/(Graph->Eval(575,0));
        pSigmaErrValues575[i] = pErrValues575[i]/(Graph->Eval(575,0));
        pSigmaValues585[i] = pValues585[i]/(Graph->Eval(585,0));
        pSigmaErrValues585[i] = pErrValues585[i]/(Graph->Eval(585,0));
        pSigmaValues595[i] = pValues595[i]/(Graph->Eval(595,0));
        pSigmaErrValues595[i] = pErrValues595[i]/(Graph->Eval(595,0));
        pSigmaValues605[i] = pValues605[i]/(Graph->Eval(605,0));
        pSigmaErrValues605[i] = pErrValues605[i]/(Graph->Eval(605,0));
        pSigmaValues615[i] = pValues615[i]/(Graph->Eval(615,0));
        pSigmaErrValues615[i] = pErrValues615[i]/(Graph->Eval(615,0));

        pSigmaValues425NegHel[i] = pValues425NegHel[i]/(Graph->Eval(425,0));
        pSigmaErrValues425NegHel[i] = pErrValues425NegHel[i]/(Graph->Eval(425,0));
        pSigmaValues435NegHel[i] = pValues435NegHel[i]/(Graph->Eval(435,0));
        pSigmaErrValues435NegHel[i] = pErrValues435NegHel[i]/(Graph->Eval(435,0));
        pSigmaValues445NegHel[i] = pValues445NegHel[i]/(Graph->Eval(445,0));
        pSigmaErrValues445NegHel[i] = pErrValues445NegHel[i]/(Graph->Eval(445,0));
        pSigmaValues455NegHel[i] = pValues455NegHel[i]/(Graph->Eval(455,0));
        pSigmaErrValues455NegHel[i] = pErrValues455NegHel[i]/(Graph->Eval(455,0));
        pSigmaValues465NegHel[i] = pValues465NegHel[i]/(Graph->Eval(465,0));
        pSigmaErrValues465NegHel[i] = pErrValues465NegHel[i]/(Graph->Eval(465,0));
        pSigmaValues475NegHel[i] = pValues475NegHel[i]/(Graph->Eval(475,0));
        pSigmaErrValues475NegHel[i] = pErrValues475NegHel[i]/(Graph->Eval(475,0));
        pSigmaValues485NegHel[i] = pValues485NegHel[i]/(Graph->Eval(485,0));
        pSigmaErrValues485NegHel[i] = pErrValues485NegHel[i]/(Graph->Eval(485,0));
        pSigmaValues495NegHel[i] = pValues495NegHel[i]/(Graph->Eval(495,0));
        pSigmaErrValues495NegHel[i] = pErrValues495NegHel[i]/(Graph->Eval(495,0));
        pSigmaValues505NegHel[i] = pValues505NegHel[i]/(Graph->Eval(505,0));
        pSigmaErrValues505NegHel[i] = pErrValues505NegHel[i]/(Graph->Eval(505,0));
        pSigmaValues515NegHel[i] = pValues515NegHel[i]/(Graph->Eval(515,0));
        pSigmaErrValues515NegHel[i] = pErrValues515NegHel[i]/(Graph->Eval(515,0));
        pSigmaValues525NegHel[i] = pValues525NegHel[i]/(Graph->Eval(525,0));
        pSigmaErrValues525NegHel[i] = pErrValues525NegHel[i]/(Graph->Eval(525,0));
        pSigmaValues535NegHel[i] = pValues535NegHel[i]/(Graph->Eval(535,0));
        pSigmaErrValues535NegHel[i] = pErrValues535NegHel[i]/(Graph->Eval(535,0));
        pSigmaValues545NegHel[i] = pValues545NegHel[i]/(Graph->Eval(545,0));
        pSigmaErrValues545NegHel[i] = pErrValues545NegHel[i]/(Graph->Eval(545,0));
        pSigmaValues555NegHel[i] = pValues555NegHel[i]/(Graph->Eval(555,0));
        pSigmaErrValues555NegHel[i] = pErrValues555NegHel[i]/(Graph->Eval(555,0));
        pSigmaValues565NegHel[i] = pValues565NegHel[i]/(Graph->Eval(565,0));
        pSigmaErrValues565NegHel[i] = pErrValues565NegHel[i]/(Graph->Eval(565,0));
        pSigmaValues575NegHel[i] = pValues575NegHel[i]/(Graph->Eval(575,0));
        pSigmaErrValues575NegHel[i] = pErrValues575NegHel[i]/(Graph->Eval(575,0));
        pSigmaValues585NegHel[i] = pValues585NegHel[i]/(Graph->Eval(585,0));
        pSigmaErrValues585NegHel[i] = pErrValues585NegHel[i]/(Graph->Eval(585,0));
        pSigmaValues595NegHel[i] = pValues595NegHel[i]/(Graph->Eval(595,0));
        pSigmaErrValues595NegHel[i] = pErrValues595NegHel[i]/(Graph->Eval(595,0));
        pSigmaValues605NegHel[i] = pValues605NegHel[i]/(Graph->Eval(605,0));
        pSigmaErrValues605NegHel[i] = pErrValues605NegHel[i]/(Graph->Eval(605,0));
        pSigmaValues615NegHel[i] = pValues615NegHel[i]/(Graph->Eval(615,0));
        pSigmaErrValues615NegHel[i] = pErrValues615NegHel[i]/(Graph->Eval(615,0));
        pSigmaValues425PosHel[i] = pValues425PosHel[i]/(Graph->Eval(425,0));
        pSigmaErrValues425PosHel[i] = pErrValues425PosHel[i]/(Graph->Eval(425,0));
        pSigmaValues435PosHel[i] = pValues435PosHel[i]/(Graph->Eval(435,0));
        pSigmaErrValues435PosHel[i] = pErrValues435PosHel[i]/(Graph->Eval(435,0));
        pSigmaValues445PosHel[i] = pValues445PosHel[i]/(Graph->Eval(445,0));
        pSigmaErrValues445PosHel[i] = pErrValues445PosHel[i]/(Graph->Eval(445,0));
        pSigmaValues455PosHel[i] = pValues455PosHel[i]/(Graph->Eval(455,0));
        pSigmaErrValues455PosHel[i] = pErrValues455PosHel[i]/(Graph->Eval(455,0));
        pSigmaValues465PosHel[i] = pValues465PosHel[i]/(Graph->Eval(465,0));
        pSigmaErrValues465PosHel[i] = pErrValues465PosHel[i]/(Graph->Eval(465,0));
        pSigmaValues475PosHel[i] = pValues475PosHel[i]/(Graph->Eval(475,0));
        pSigmaErrValues475PosHel[i] = pErrValues475PosHel[i]/(Graph->Eval(475,0));
        pSigmaValues485PosHel[i] = pValues485PosHel[i]/(Graph->Eval(485,0));
        pSigmaErrValues485PosHel[i] = pErrValues485PosHel[i]/(Graph->Eval(485,0));
        pSigmaValues495PosHel[i] = pValues495PosHel[i]/(Graph->Eval(495,0));
        pSigmaErrValues495PosHel[i] = pErrValues495PosHel[i]/(Graph->Eval(495,0));
        pSigmaValues505PosHel[i] = pValues505PosHel[i]/(Graph->Eval(505,0));
        pSigmaErrValues505PosHel[i] = pErrValues505PosHel[i]/(Graph->Eval(505,0));
        pSigmaValues515PosHel[i] = pValues515PosHel[i]/(Graph->Eval(515,0));
        pSigmaErrValues515PosHel[i] = pErrValues515PosHel[i]/(Graph->Eval(515,0));
        pSigmaValues525PosHel[i] = pValues525PosHel[i]/(Graph->Eval(525,0));
        pSigmaErrValues525PosHel[i] = pErrValues525PosHel[i]/(Graph->Eval(525,0));
        pSigmaValues535PosHel[i] = pValues535PosHel[i]/(Graph->Eval(535,0));
        pSigmaErrValues535PosHel[i] = pErrValues535PosHel[i]/(Graph->Eval(535,0));
        pSigmaValues545PosHel[i] = pValues545PosHel[i]/(Graph->Eval(545,0));
        pSigmaErrValues545PosHel[i] = pErrValues545PosHel[i]/(Graph->Eval(545,0));
        pSigmaValues555PosHel[i] = pValues555PosHel[i]/(Graph->Eval(555,0));
        pSigmaErrValues555PosHel[i] = pErrValues555PosHel[i]/(Graph->Eval(555,0));
        pSigmaValues565PosHel[i] = pValues565PosHel[i]/(Graph->Eval(565,0));
        pSigmaErrValues565PosHel[i] = pErrValues565PosHel[i]/(Graph->Eval(565,0));
        pSigmaValues575PosHel[i] = pValues575PosHel[i]/(Graph->Eval(575,0));
        pSigmaErrValues575PosHel[i] = pErrValues575PosHel[i]/(Graph->Eval(575,0));
        pSigmaValues585PosHel[i] = pValues585PosHel[i]/(Graph->Eval(585,0));
        pSigmaErrValues585PosHel[i] = pErrValues585PosHel[i]/(Graph->Eval(585,0));
        pSigmaValues595PosHel[i] = pValues595PosHel[i]/(Graph->Eval(595,0));
        pSigmaErrValues595PosHel[i] = pErrValues595PosHel[i]/(Graph->Eval(595,0));
        pSigmaValues605PosHel[i] = pValues605PosHel[i]/(Graph->Eval(605,0));
        pSigmaErrValues605PosHel[i] = pErrValues605PosHel[i]/(Graph->Eval(605,0));
        pSigmaValues615PosHel[i] = pValues615PosHel[i]/(Graph->Eval(615,0));
        pSigmaErrValues615PosHel[i] = pErrValues615PosHel[i]/(Graph->Eval(615,0));

    }

    TFile f3("Sigma_Plots_NoScatt_10_V3.root", "RECREATE");

    Float_t xMin = -1;
    Float_t xMax = 1;
    Float_t yMin = -5;
    Float_t yMax = 5;
    Double_t x[10] = {0.9, 0.7, 0.5, 0.3, 0.1, -0.1, -0.3, -0.5, -0.7, -0.9}; // Need to adjust
    Double_t ex[10] = {0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1}; // Need to adjust

    TCanvas *canvas = new TCanvas("canvas","canvas", 1920, 1080);
    TPad *pad1 = new TPad("pad1","",0,0,1,1);
    pad1->Draw();
    pad1->cd();

    pad1->SetTickx(1);
    pad1->SetTicky(1);
    pad1->SetGridx(0);
    pad1->SetGridy(0);
    TH1F  *hr;
    hr = canvas->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 420-430MeV)");

    gr1 = new TGraphErrors(10, x, pSigmaValues425NegHel, ex, pSigmaErrValues425NegHel);
    gr1->Fit("LegendreFit");
    gr1->SetMarkerColor(4);
    gr1->SetLineColor(4);
    gr1->SetLineWidth(3);
    gr1->SetMarkerStyle(8);
    gr1->SetMarkerSize(1.5);
    gr1->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 420-430MeV)");
    gr1->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr1->GetYaxis()->SetTitle("#Sigma");
    gr1->SetName("Sigma425NegHel");
    gr1->Draw("epz");
    gr1a = new TGraphErrors(10, x, pSigmaValues425PosHel, ex, pSigmaErrValues425PosHel);
    gr1a->SetMarkerColor(2);
    gr1a->SetLineColor(2);
    gr1a->SetLineWidth(3);
    gr1a->SetMarkerStyle(24);
    gr1a->SetMarkerSize(1.5);
    gr1a->SetName("Sigma425PosHel");
    gr1a->Draw("epsamez");
    gr1b = new TGraphErrors(10, x, pSigmaValues425, ex, pSigmaErrValues425);
    gr1b->SetMarkerColor(1);
    gr1b->SetLineColor(1);
    gr1b->SetLineWidth(3);
    gr1b->SetMarkerStyle(33);
    gr1b->SetMarkerSize(2);
    gr1b->SetName("Sigma425");
    gr1b->Draw("epsamez");

    TCanvas *canvas1 = new TCanvas("canvas1","canvas1", 1920, 1080);
    TPad *pad2 = new TPad("pad2","",0,0,1,1);
    pad2->Draw();
    pad2->cd();

    pad2->SetTickx(1);
    pad2->SetTicky(1);
    pad2->SetGridx(0);
    pad2->SetGridy(0);
    TH1F  *hr1;
    hr1 = canvas1->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr1->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 430-440MeV)");

    gr2 = new TGraphErrors(10, x, pSigmaValues435NegHel, ex, pSigmaErrValues435NegHel);
    gr2->Fit("LegendreFit");
    gr2->SetMarkerColor(4);
    gr2->SetLineColor(4);
    gr2->SetLineWidth(3);
    gr2->SetMarkerStyle(8);
    gr2->SetMarkerSize(1.5);
    gr2->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 430-440MeV)");
    gr2->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr2->GetYaxis()->SetTitle("#Sigma");
    gr2->SetName("Sigma435NegHel");
    gr2->Draw("epz");
    gr2a = new TGraphErrors(10, x, pSigmaValues435PosHel, ex, pSigmaErrValues435PosHel);
    gr2a->SetMarkerColor(2);
    gr2a->SetLineColor(2);
    gr2a->SetLineWidth(3);
    gr2a->SetMarkerStyle(24);
    gr2a->SetMarkerSize(1.5);
    gr2a->SetName("Sigma435PosHel");
    gr2a->Draw("epsamez");
    gr2b = new TGraphErrors(10, x, pSigmaValues435, ex, pSigmaErrValues435);
    gr2b->SetMarkerColor(1);
    gr2b->SetLineColor(1);
    gr2b->SetLineWidth(3);
    gr2b->SetMarkerStyle(33);
    gr2b->SetMarkerSize(2);
    gr2b->SetName("Sigma435");
    gr2b->Draw("epsamez");

    TCanvas *canvas2 = new TCanvas("canvas2","canvas2", 1920, 1080);
    TPad *pad3 = new TPad("pad3","",0,0,1,1);
    pad3->Draw();
    pad3->cd();

    pad3->SetTickx(1);
    pad3->SetTicky(1);
    pad3->SetGridx(0);
    pad3->SetGridy(0);
    TH1F  *hr2;
    hr2 = canvas2->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr2->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 440-450MeV)");

    gr3 = new TGraphErrors(10, x, pSigmaValues445NegHel, ex, pSigmaErrValues445NegHel);
    gr3->Fit("LegendreFit");
    gr3->SetMarkerColor(4);
    gr3->SetLineColor(4);
    gr3->SetLineWidth(3);
    gr3->SetMarkerStyle(8);
    gr3->SetMarkerSize(1.5);
    gr3->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 440-450MeV)");
    gr3->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr3->GetYaxis()->SetTitle("#Sigma");
    gr3->SetName("Sigma445NegHel");
    gr3->Draw("epz");
    gr3a = new TGraphErrors(10, x, pSigmaValues445PosHel, ex, pSigmaErrValues445PosHel);
    gr3a->SetMarkerColor(2);
    gr3a->SetLineColor(2);
    gr3a->SetLineWidth(3);
    gr3a->SetMarkerStyle(24);
    gr3a->SetMarkerSize(1.5);
    gr3a->SetName("Sigma445PosHel");
    gr3a->Draw("epsamez");
    gr3b = new TGraphErrors(10, x, pSigmaValues445, ex, pSigmaErrValues445);
    gr3b->SetMarkerColor(1);
    gr3b->SetLineColor(1);
    gr3b->SetLineWidth(3);
    gr3b->SetMarkerStyle(33);
    gr3b->SetMarkerSize(2);
    gr3b->SetName("Sigma445");
    gr3b->Draw("epsamez");

    TCanvas *canvas3 = new TCanvas("canvas3","canvas3", 1920, 1080);
    TPad *pad4 = new TPad("pad4","",0,0,1,1);
    pad4->Draw();
    pad4->cd();

    pad4->SetTickx(1);
    pad4->SetTicky(1);
    pad4->SetGridx(0);
    pad4->SetGridy(0);
    TH1F  *hr3;
    hr3 = canvas3->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr3->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 450-460MeV)");

    gr4 = new TGraphErrors(10, x, pSigmaValues455NegHel, ex, pSigmaErrValues455NegHel);
    gr4->Fit("LegendreFit");
    gr4->SetMarkerColor(4);
    gr4->SetLineColor(4);
    gr4->SetLineWidth(3);
    gr4->SetMarkerStyle(8);
    gr4->SetMarkerSize(1.5);
    gr4->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 450-460MeV)");
    gr4->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr4->GetYaxis()->SetTitle("#Sigma");
    gr4->SetName("Sigma455NegHel");
    gr4->Draw("epz");
    gr4a = new TGraphErrors(10, x, pSigmaValues455PosHel, ex, pSigmaErrValues455PosHel);
    gr4a->SetMarkerColor(2);
    gr4a->SetLineColor(2);
    gr4a->SetLineWidth(3);
    gr4a->SetMarkerStyle(24);
    gr4a->SetMarkerSize(1.5);
    gr4a->SetName("Sigma455PosHel");
    gr4a->Draw("epsamez");
    gr4b = new TGraphErrors(10, x, pSigmaValues455, ex, pSigmaErrValues455);
    gr4b->SetMarkerColor(1);
    gr4b->SetLineColor(1);
    gr4b->SetLineWidth(3);
    gr4b->SetMarkerStyle(33);
    gr4b->SetMarkerSize(2);
    gr4b->SetName("Sigma455");
    gr4b->Draw("epsamez");

    TCanvas *canvas4 = new TCanvas("canvas4","canvas4", 1920, 1080);
    TPad *pad5 = new TPad("pad5","",0,0,1,1);
    pad5->Draw();
    pad5->cd();

    pad5->SetTickx(1);
    pad5->SetTicky(1);
    pad5->SetGridx(0);
    pad5->SetGridy(0);
    TH1F  *hr4;
    hr4 = canvas4->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr4->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 460-470MeV)");

    gr5 = new TGraphErrors(10, x, pSigmaValues465NegHel, ex, pSigmaErrValues465NegHel);
    gr5->Fit("LegendreFit");
    gr5->SetMarkerColor(4);
    gr5->SetLineColor(4);
    gr5->SetLineWidth(3);
    gr5->SetMarkerStyle(8);
    gr5->SetMarkerSize(1.5);
    gr5->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 460-470MeV)");
    gr5->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr5->GetYaxis()->SetTitle("#Sigma");
    gr5->SetName("Sigma465NegHel");
    gr5->Draw("epz");
    gr5a = new TGraphErrors(10, x, pSigmaValues465PosHel, ex, pSigmaErrValues465PosHel);
    gr5a->SetMarkerColor(2);
    gr5a->SetLineColor(2);
    gr5a->SetLineWidth(3);
    gr5a->SetMarkerStyle(24);
    gr5a->SetMarkerSize(1.5);
    gr5a->SetName("Sigma465PosHel");
    gr5a->Draw("epsamez");
    gr5b = new TGraphErrors(10, x, pSigmaValues465, ex, pSigmaErrValues465);
    gr5b->SetMarkerColor(1);
    gr5b->SetLineColor(1);
    gr5b->SetLineWidth(3);
    gr5b->SetMarkerStyle(33);
    gr5b->SetMarkerSize(2);
    gr5b->SetName("Sigma465");
    gr5b->Draw("epsamez");

    TCanvas *canvas5 = new TCanvas("canvas5","canvas5", 1920, 1080);
    TPad *pad6 = new TPad("pad6","",0,0,1,1);
    pad6->Draw();
    pad6->cd();

    pad6->SetTickx(1);
    pad6->SetTicky(1);
    pad6->SetGridx(0);
    pad6->SetGridy(0);
    TH1F  *hr5;
    hr5 = canvas5->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr5->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 470-480MeV)");

    gr6 = new TGraphErrors(10, x, pSigmaValues475NegHel, ex, pSigmaErrValues475NegHel);
    gr6->Fit("LegendreFit");
    gr6->SetMarkerColor(4);
    gr6->SetLineColor(4);
    gr6->SetLineWidth(3);
    gr6->SetMarkerStyle(8);
    gr6->SetMarkerSize(1.5);
    gr6->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 470-480MeV)");
    gr6->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr6->GetYaxis()->SetTitle("#Sigma");
    gr6->SetName("Sigma475NegHel");
    gr6->Draw("epz");
    gr6a = new TGraphErrors(10, x, pSigmaValues475PosHel, ex, pSigmaErrValues475PosHel);
    gr6a->SetMarkerColor(2);
    gr6a->SetLineColor(2);
    gr6a->SetLineWidth(3);
    gr6a->SetMarkerStyle(24);
    gr6a->SetMarkerSize(1.5);
    gr6a->SetName("Sigma475PosHel");
    gr6a->Draw("epsamez");
    gr6b = new TGraphErrors(10, x, pSigmaValues475, ex, pSigmaErrValues475);
    gr6b->SetMarkerColor(1);
    gr6b->SetLineColor(1);
    gr6b->SetLineWidth(3);
    gr6b->SetMarkerStyle(33);
    gr6b->SetMarkerSize(2);
    gr6b->SetName("Sigma475");
    gr6b->Draw("epsamez");

    TCanvas *canvas6 = new TCanvas("canvas6","canvas6", 1920, 1080);
    TPad *pad7 = new TPad("pad7","",0,0,1,1);
    pad7->Draw();
    pad7->cd();

    pad7->SetTickx(1);
    pad7->SetTicky(1);
    pad7->SetGridx(0);
    pad7->SetGridy(0);
    TH1F  *hr6;
    hr6 = canvas6->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr6->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 480-490MeV)");

    gr7 = new TGraphErrors(10, x, pSigmaValues485NegHel, ex, pSigmaErrValues485NegHel);
    gr7->Fit("LegendreFit");
    gr7->SetMarkerColor(4);
    gr7->SetLineColor(4);
    gr7->SetLineWidth(3);
    gr7->SetMarkerStyle(8);
    gr7->SetMarkerSize(1.5);
    gr7->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 480-490MeV)");
    gr7->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr7->GetYaxis()->SetTitle("#Sigma");
    gr7->SetName("Sigma485NegHel");
    gr7->Draw("epz");
    gr7a = new TGraphErrors(10, x, pSigmaValues485PosHel, ex, pSigmaErrValues485PosHel);
    gr7a->SetMarkerColor(2);
    gr7a->SetLineColor(2);
    gr7a->SetLineWidth(3);
    gr7a->SetMarkerStyle(24);
    gr7a->SetMarkerSize(1.5);
    gr7a->SetName("Sigma485PosHel");
    gr7a->Draw("epsamez");
    gr7b = new TGraphErrors(10, x, pSigmaValues485, ex, pSigmaErrValues485);
    gr7b->SetMarkerColor(1);
    gr7b->SetLineColor(1);
    gr7b->SetLineWidth(3);
    gr7b->SetMarkerStyle(33);
    gr7b->SetMarkerSize(2);
    gr7b->SetName("Sigma485");
    gr7b->Draw("epsamez");

    TCanvas *canvas7 = new TCanvas("canvas7","canvas7", 1920, 1080);
    TPad *pad8 = new TPad("pad8","",0,0,1,1);
    pad8->Draw();
    pad8->cd();

    pad8->SetTickx(1);
    pad8->SetTicky(1);
    pad8->SetGridx(0);
    pad8->SetGridy(0);
    TH1F  *hr7;
    hr7 = canvas7->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr7->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 490-500MeV)");

    gr8 = new TGraphErrors(10, x, pSigmaValues495NegHel, ex, pSigmaErrValues495NegHel);
    gr8->Fit("LegendreFit");
    gr8->SetMarkerColor(4);
    gr8->SetLineColor(4);
    gr8->SetLineWidth(3);
    gr8->SetMarkerStyle(8);
    gr8->SetMarkerSize(1.5);
    gr8->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 490-500MeV)");
    gr8->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr8->GetYaxis()->SetTitle("#Sigma");
    gr8->SetName("Sigma495NegHel");
    gr8->Draw("epz");
    gr8a = new TGraphErrors(10, x, pSigmaValues495PosHel, ex, pSigmaErrValues495PosHel);
    gr8a->SetMarkerColor(2);
    gr8a->SetLineColor(2);
    gr8a->SetLineWidth(3);
    gr8a->SetMarkerStyle(24);
    gr8a->SetMarkerSize(1.5);
    gr8a->SetName("Sigma495PosHel");
    gr8a->Draw("epsamez");
    gr8b = new TGraphErrors(10, x, pSigmaValues495, ex, pSigmaErrValues495);
    gr8b->SetMarkerColor(1);
    gr8b->SetLineColor(1);
    gr8b->SetLineWidth(3);
    gr8b->SetMarkerStyle(33);
    gr8b->SetMarkerSize(2);
    gr8b->SetName("Sigma495");
    gr8b->Draw("epsamez");

    TCanvas *canvas8 = new TCanvas("canvas8","canvas8", 1920, 1080);
    TPad *pad9 = new TPad("pad9","",0,0,1,1);
    pad9->Draw();
    pad9->cd();

    pad9->SetTickx(1);
    pad9->SetTicky(1);
    pad9->SetGridx(0);
    pad9->SetGridy(0);
    TH1F  *hr8;
    hr8 = canvas8->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr8->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 500-510MeV)");

    gr9 = new TGraphErrors(10, x, pSigmaValues505NegHel, ex, pSigmaErrValues505NegHel);
    gr9->Fit("LegendreFit");
    gr9->SetMarkerColor(4);
    gr9->SetLineColor(4);
    gr9->SetLineWidth(3);
    gr9->SetMarkerStyle(8);
    gr9->SetMarkerSize(1.5);
    gr9->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 500-510MeV)");
    gr9->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr9->GetYaxis()->SetTitle("#Sigma");
    gr9->SetName("Sigma505NegHel");
    gr9->Draw("epz");
    gr9a = new TGraphErrors(10, x, pSigmaValues505PosHel, ex, pSigmaErrValues505PosHel);
    gr9a->SetMarkerColor(2);
    gr9a->SetLineColor(2);
    gr9a->SetLineWidth(3);
    gr9a->SetMarkerStyle(24);
    gr9a->SetMarkerSize(1.5);
    gr9a->SetName("Sigma505PosHel");
    gr9a->Draw("epsamez");
    gr9b = new TGraphErrors(10, x, pSigmaValues505, ex, pSigmaErrValues505);
    gr9b->SetMarkerColor(1);
    gr9b->SetLineColor(1);
    gr9b->SetLineWidth(3);
    gr9b->SetMarkerStyle(33);
    gr9b->SetMarkerSize(2);
    gr9b->SetName("Sigma505");
    gr9b->Draw("epsamez");

    TCanvas *canvas9 = new TCanvas("canvas9","canvas9", 1920, 1080);
    TPad *pad10 = new TPad("pad10","",0,0,1,1);
    pad10->Draw();
    pad10->cd();

    pad10->SetTickx(1);
    pad10->SetTicky(1);
    pad10->SetGridx(0);
    pad10->SetGridy(0);
    TH1F  *hr9;
    hr9 = canvas9->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr9->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 510-520MeV)");

    gr10 = new TGraphErrors(10, x, pSigmaValues515NegHel, ex, pSigmaErrValues515NegHel);
    gr10->Fit("LegendreFit");
    gr10->SetMarkerColor(4);
    gr10->SetLineColor(4);
    gr10->SetLineWidth(3);
    gr10->SetMarkerStyle(8);
    gr10->SetMarkerSize(1.5);
    gr10->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 510-520MeV)");
    gr10->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr10->GetYaxis()->SetTitle("#Sigma");
    gr10->SetName("Sigma515NegHel");
    gr10->Draw("epz");
    gr10a = new TGraphErrors(10, x, pSigmaValues515PosHel, ex, pSigmaErrValues515PosHel);
    gr10a->SetMarkerColor(2);
    gr10a->SetLineColor(2);
    gr10a->SetLineWidth(3);
    gr10a->SetMarkerStyle(24);
    gr10a->SetMarkerSize(1.5);
    gr10a->SetName("Sigma515PosHel");
    gr10a->Draw("epsamez");
    gr10b = new TGraphErrors(10, x, pSigmaValues515, ex, pSigmaErrValues515);
    gr10b->SetMarkerColor(1);
    gr10b->SetLineColor(1);
    gr10b->SetLineWidth(3);
    gr10b->SetMarkerStyle(33);
    gr10b->SetMarkerSize(2);
    gr10b->SetName("Sigma515");
    gr10b->Draw("epsamez");

    TCanvas *canvas10 = new TCanvas("canvas10","canvas10", 1920, 1080);
    TPad *pad11 = new TPad("pad11","",0,0,1,1);
    pad11->Draw();
    pad11->cd();

    pad11->SetTickx(1);
    pad11->SetTicky(1);
    pad11->SetGridx(0);
    pad11->SetGridy(0);
    TH1F  *hr10;
    hr10 = canvas10->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr10->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 520-530MeV)");

    gr11 = new TGraphErrors(10, x, pSigmaValues525NegHel, ex, pSigmaErrValues525NegHel);
    gr11->Fit("LegendreFit");
    gr11->SetMarkerColor(4);
    gr11->SetLineColor(4);
    gr11->SetLineWidth(3);
    gr11->SetMarkerStyle(8);
    gr11->SetMarkerSize(1.5);
    gr11->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 520-530MeV)");
    gr11->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr11->GetYaxis()->SetTitle("#Sigma");
    gr11->SetName("Sigma525NegHel");
    gr11->Draw("epz");
    gr11a = new TGraphErrors(10, x, pSigmaValues525PosHel, ex, pSigmaErrValues525PosHel);
    gr11a->SetMarkerColor(2);
    gr11a->SetLineColor(2);
    gr11a->SetLineWidth(3);
    gr11a->SetMarkerStyle(24);
    gr11a->SetMarkerSize(1.5);
    gr11a->SetName("Sigma525PosHel");
    gr11a->Draw("epsamez");
    gr11b = new TGraphErrors(10, x, pSigmaValues525, ex, pSigmaErrValues525);
    gr11b->SetMarkerColor(1);
    gr11b->SetLineColor(1);
    gr11b->SetLineWidth(3);
    gr11b->SetMarkerStyle(33);
    gr11b->SetMarkerSize(2);
    gr11b->SetName("Sigma525");
    gr11b->Draw("epsamez");

    TCanvas *canvas11 = new TCanvas("canvas11","canvas11", 1920, 1080);
    TPad *pad12 = new TPad("pad12","",0,0,1,1);
    pad12->Draw();
    pad12->cd();

    pad12->SetTickx(1);
    pad12->SetTicky(1);
    pad12->SetGridx(0);
    pad12->SetGridy(0);
    TH1F  *hr11;
    hr11 = canvas11->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr11->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 530-540MeV)");

    gr12 = new TGraphErrors(10, x, pSigmaValues535NegHel, ex, pSigmaErrValues535NegHel);
    gr12->Fit("LegendreFit");
    gr12->SetMarkerColor(4);
    gr12->SetLineColor(4);
    gr12->SetLineWidth(3);
    gr12->SetMarkerStyle(8);
    gr12->SetMarkerSize(1.5);
    gr12->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 530-540MeV)");
    gr12->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr12->GetYaxis()->SetTitle("#Sigma");
    gr12->SetName("Sigma535NegHel");
    gr12->Draw("epz");
    gr12a = new TGraphErrors(10, x, pSigmaValues535PosHel, ex, pSigmaErrValues535PosHel);
    gr12a->SetMarkerColor(2);
    gr12a->SetLineColor(2);
    gr12a->SetLineWidth(3);
    gr12a->SetMarkerStyle(24);
    gr12a->SetMarkerSize(1.5);
    gr12a->SetName("Sigma535PosHel");
    gr12a->Draw("epsamez");
    gr12b = new TGraphErrors(10, x, pSigmaValues535, ex, pSigmaErrValues535);
    gr12b->SetMarkerColor(1);
    gr12b->SetLineColor(1);
    gr12b->SetLineWidth(3);
    gr12b->SetMarkerStyle(33);
    gr12b->SetMarkerSize(2);
    gr12b->SetName("Sigma535");
    gr12b->Draw("epsamez");

    TCanvas *canvas12 = new TCanvas("canvas12","canvas12", 1920, 1080);
    TPad *pad13 = new TPad("pad13","",0,0,1,1);
    pad13->Draw();
    pad13->cd();

    pad13->SetTickx(1);
    pad13->SetTicky(1);
    pad13->SetGridx(0);
    pad13->SetGridy(0);
    TH1F  *hr12;
    hr12 = canvas12->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr12->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 540-550MeV)");

    gr13 = new TGraphErrors(10, x, pSigmaValues545NegHel, ex, pSigmaErrValues545NegHel);
    gr13->Fit("LegendreFit");
    gr13->SetMarkerColor(4);
    gr13->SetLineColor(4);
    gr13->SetLineWidth(3);
    gr13->SetMarkerStyle(8);
    gr13->SetMarkerSize(1.5);
    gr13->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 540-550MeV)");
    gr13->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr13->GetYaxis()->SetTitle("#Sigma");
    gr13->SetName("Sigma545NegHel");
    gr13->Draw("epz");
    gr13a = new TGraphErrors(10, x, pSigmaValues545PosHel, ex, pSigmaErrValues545PosHel);
    gr13a->SetMarkerColor(2);
    gr13a->SetLineColor(2);
    gr13a->SetLineWidth(3);
    gr13a->SetMarkerStyle(24);
    gr13a->SetMarkerSize(1.5);
    gr13a->SetName("Sigma545PosHel");
    gr13a->Draw("epsamez");
    gr13b = new TGraphErrors(10, x, pSigmaValues545, ex, pSigmaErrValues545);
    gr13b->SetMarkerColor(1);
    gr13b->SetLineColor(1);
    gr13b->SetLineWidth(3);
    gr13b->SetMarkerStyle(33);
    gr13b->SetMarkerSize(2);
    gr13b->SetName("Sigma545");
    gr13b->Draw("epsamez");

    TCanvas *canvas13 = new TCanvas("canvas13","canvas13", 1920, 1080);
    TPad *pad14 = new TPad("pad14","",0,0,1,1);
    pad14->Draw();
    pad14->cd();

    pad14->SetTickx(1);
    pad14->SetTicky(1);
    pad14->SetGridx(0);
    pad14->SetGridy(0);
    TH1F  *hr13;
    hr13 = canvas13->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr13->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 550-560MeV)");

    gr14 = new TGraphErrors(10, x, pSigmaValues555NegHel, ex, pSigmaErrValues555NegHel);
    gr14->Fit("LegendreFit");
    gr14->SetMarkerColor(4);
    gr14->SetLineColor(4);
    gr14->SetLineWidth(3);
    gr14->SetMarkerStyle(8);
    gr14->SetMarkerSize(1.5);
    gr14->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 550-560MeV)");
    gr14->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr14->GetYaxis()->SetTitle("#Sigma");
    gr14->SetName("Sigma555NegHel");
    gr14->Draw("epz");
    gr14a = new TGraphErrors(10, x, pSigmaValues555PosHel, ex, pSigmaErrValues555PosHel);
    gr14a->SetMarkerColor(2);
    gr14a->SetLineColor(2);
    gr14a->SetLineWidth(3);
    gr14a->SetMarkerStyle(24);
    gr14a->SetMarkerSize(1.5);
    gr14a->SetName("Sigma555PosHel");
    gr14a->Draw("epsamez");
    gr14b = new TGraphErrors(10, x, pSigmaValues555, ex, pSigmaErrValues555);
    gr14b->SetMarkerColor(1);
    gr14b->SetLineColor(1);
    gr14b->SetLineWidth(3);
    gr14b->SetMarkerStyle(33);
    gr14b->SetMarkerSize(2);
    gr14b->SetName("Sigma555");
    gr14b->Draw("epsamez");

    TCanvas *canvas14 = new TCanvas("canvas14","canvas14", 1920, 1080);
    TPad *pad15 = new TPad("pad15","",0,0,1,1);
    pad15->Draw();
    pad15->cd();

    pad15->SetTickx(1);
    pad15->SetTicky(1);
    pad15->SetGridx(0);
    pad15->SetGridy(0);
    TH1F  *hr14;
    hr14 = canvas14->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr14->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 560-570MeV)");

    gr15 = new TGraphErrors(10, x, pSigmaValues565NegHel, ex, pSigmaErrValues565NegHel);
    gr15->Fit("LegendreFit");
    gr15->SetMarkerColor(4);
    gr15->SetLineColor(4);
    gr15->SetLineWidth(3);
    gr15->SetMarkerStyle(8);
    gr15->SetMarkerSize(1.5);
    gr15->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 560-570MeV)");
    gr15->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr15->GetYaxis()->SetTitle("#Sigma");
    gr15->SetName("Sigma565NegHel");
    gr15->Draw("epz");
    gr15a = new TGraphErrors(10, x, pSigmaValues565PosHel, ex, pSigmaErrValues565PosHel);
    gr15a->SetMarkerColor(2);
    gr15a->SetLineColor(2);
    gr15a->SetLineWidth(3);
    gr15a->SetMarkerStyle(24);
    gr15a->SetMarkerSize(1.5);
    gr15a->SetName("Sigma565PosHel");
    gr15a->Draw("epsamez");
    gr15b = new TGraphErrors(10, x, pSigmaValues565, ex, pSigmaErrValues565);
    gr15b->SetMarkerColor(1);
    gr15b->SetLineColor(1);
    gr15b->SetLineWidth(3);
    gr15b->SetMarkerStyle(33);
    gr15b->SetMarkerSize(2);
    gr15b->SetName("Sigma565");
    gr15b->Draw("epsamez");

    TCanvas *canvas15 = new TCanvas("canvas15","canvas15", 1920, 1080);
    TPad *pad16 = new TPad("pad16","",0,0,1,1);
    pad16->Draw();
    pad16->cd();

    pad16->SetTickx(1);
    pad16->SetTicky(1);
    pad16->SetGridx(0);
    pad16->SetGridy(0);
    TH1F  *hr15;
    hr15 = canvas15->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr15->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 570-580MeV)");

    gr16 = new TGraphErrors(10, x, pSigmaValues575NegHel, ex, pSigmaErrValues575NegHel);
    gr16->Fit("LegendreFit");
    gr16->SetMarkerColor(4);
    gr16->SetLineColor(4);
    gr16->SetLineWidth(3);
    gr16->SetMarkerStyle(8);
    gr16->SetMarkerSize(1.5);
    gr16->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 570-580MeV)");
    gr16->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr16->GetYaxis()->SetTitle("#Sigma");
    gr16->SetName("Sigma575NegHel");
    gr16->Draw("epz");
    gr16a = new TGraphErrors(10, x, pSigmaValues575PosHel, ex, pSigmaErrValues575PosHel);
    gr16a->SetMarkerColor(2);
    gr16a->SetLineColor(2);
    gr16a->SetLineWidth(3);
    gr16a->SetMarkerStyle(24);
    gr16a->SetMarkerSize(1.5);
    gr16a->SetName("Sigma575PosHel");
    gr16a->Draw("epsamez");
    gr16b = new TGraphErrors(10, x, pSigmaValues575, ex, pSigmaErrValues575);
    gr16b->SetMarkerColor();
    gr16b->SetLineColor(1);
    gr16b->SetLineWidth(3);
    gr16b->SetMarkerStyle(33);
    gr16b->SetMarkerSize(2);
    gr16b->SetName("Sigma575");
    gr16b->Draw("epsamez");

    TCanvas *canvas16 = new TCanvas("canvas16","canvas16", 1920, 1080);
    TPad *pad17 = new TPad("pad17","",0,0,1,1);
    pad17->Draw();
    pad17->cd();

    pad17->SetTickx(1);
    pad17->SetTicky(1);
    pad17->SetGridx(0);
    pad17->SetGridy(0);
    TH1F  *hr16;
    hr16 = canvas16->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr16->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 580-590MeV)");

    gr17 = new TGraphErrors(10, x, pSigmaValues585NegHel, ex, pSigmaErrValues585NegHel);
    gr17->Fit("LegendreFit");
    gr17->SetMarkerColor(4);
    gr17->SetLineColor(4);
    gr17->SetLineWidth(3);
    gr17->SetMarkerStyle(8);
    gr17->SetMarkerSize(1.5);
    gr17->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 580-590MeV)");
    gr17->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr17->GetYaxis()->SetTitle("#Sigma");
    gr17->SetName("Sigma585NegHel");
    gr17->Draw("epz");
    gr17a = new TGraphErrors(10, x, pSigmaValues585PosHel, ex, pSigmaErrValues585PosHel);
    gr17a->SetMarkerColor(2);
    gr17a->SetLineColor(2);
    gr17a->SetLineWidth(3);
    gr17a->SetMarkerStyle(24);
    gr17a->SetMarkerSize(1.5);
    gr17a->SetName("Sigma585PosHel");
    gr17a->Draw("epsamez");
    gr17b = new TGraphErrors(10, x, pSigmaValues585, ex, pSigmaErrValues585);
    gr17b->SetMarkerColor(1);
    gr17b->SetLineColor(1);
    gr17b->SetLineWidth(3);
    gr17b->SetMarkerStyle(33);
    gr17b->SetMarkerSize(2);
    gr17b->SetName("Sigma585");
    gr17b->Draw("epsamez");

    TCanvas *canvas17 = new TCanvas("canvas17","canvas17", 1920, 1080);
    TPad *pad18 = new TPad("pad18","",0,0,1,1);
    pad18->Draw();
    pad18->cd();

    pad18->SetTickx(1);
    pad18->SetTicky(1);
    pad18->SetGridx(0);
    pad18->SetGridy(0);
    TH1F  *hr17;
    hr17 = canvas17->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr17->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 590-600MeV)");

    gr18 = new TGraphErrors(10, x, pSigmaValues595NegHel, ex, pSigmaErrValues595NegHel);
    gr18->Fit("LegendreFit");
    gr18->SetMarkerColor(4);
    gr18->SetLineColor(4);
    gr18->SetLineWidth(3);
    gr18->SetMarkerStyle(8);
    gr18->SetMarkerSize(1.5);
    gr18->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 590-600MeV)");
    gr18->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr18->GetYaxis()->SetTitle("#Sigma");
    gr18->SetName("Sigma595NegHel");
    gr18->Draw("epz");
    gr18a = new TGraphErrors(10, x, pSigmaValues595PosHel, ex, pSigmaErrValues595PosHel);
    gr18a->SetMarkerColor(2);
    gr18a->SetLineColor(2);
    gr18a->SetLineWidth(3);
    gr18a->SetMarkerStyle(24);
    gr18a->SetMarkerSize(1.5);
    gr18a->SetName("Sigma595PosHel");
    gr18a->Draw("epsamez");
    gr18b = new TGraphErrors(10, x, pSigmaValues595, ex, pSigmaErrValues595);
    gr18b->SetMarkerColor(1);
    gr18b->SetLineColor(1);
    gr18b->SetLineWidth(3);
    gr18b->SetMarkerStyle(33);
    gr18b->SetMarkerSize(2);
    gr18b->SetName("Sigma595");
    gr18b->Draw("epsamez");

    TCanvas *canvas18 = new TCanvas("canvas18","canvas18", 1920, 1080);
    TPad *pad19 = new TPad("pad19","",0,0,1,1);
    pad19->Draw();
    pad19->cd();

    pad19->SetTickx(1);
    pad19->SetTicky(1);
    pad19->SetGridx(0);
    pad19->SetGridy(0);
    TH1F  *hr18;
    hr18 = canvas18->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr18->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 600-610MeV)");

    gr19 = new TGraphErrors(10, x, pSigmaValues605NegHel, ex, pSigmaErrValues605NegHel);
    gr19->Fit("LegendreFit");
    gr19->SetMarkerColor(4);
    gr19->SetLineColor(4);
    gr19->SetLineWidth(3);
    gr19->SetMarkerStyle(8);
    gr19->SetMarkerSize(1.5);
    gr19->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 600-610MeV)");
    gr19->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr19->GetYaxis()->SetTitle("#Sigma");
    gr19->SetName("Sigma605NegHel");
    gr19->Draw("epz");
    gr19a = new TGraphErrors(10, x, pSigmaValues605PosHel, ex, pSigmaErrValues605PosHel);
    gr19a->SetMarkerColor(2);
    gr19a->SetLineColor(2);
    gr19a->SetLineWidth(3);
    gr19a->SetMarkerStyle(24);
    gr19a->SetMarkerSize(1.5);
    gr19a->SetName("Sigma605PosHel");
    gr19a->Draw("epsamez");
    gr19b = new TGraphErrors(10, x, pSigmaValues605, ex, pSigmaErrValues605);
    gr19b->SetMarkerColor(1);
    gr19b->SetLineColor(1);
    gr19b->SetLineWidth(3);
    gr19b->SetMarkerStyle(33);
    gr19b->SetMarkerSize(2);
    gr19b->SetName("Sigma605");
    gr19b->Draw("epsamez");

    TCanvas *canvas19 = new TCanvas("canvas19","canvas19", 1920, 1080);
    TPad *pad20 = new TPad("pad20","",0,0,1,1);
    pad20->Draw();
    pad20->cd();

    pad20->SetTickx(1);
    pad20->SetTicky(1);
    pad20->SetGridx(0);
    pad20->SetGridy(0);
    TH1F  *hr19;
    hr19 = canvas19->DrawFrame(xMin, -0.6 , xMax, 0.6);
    hr19->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 610-620MeV)");

    gr20 = new TGraphErrors(10, x, pSigmaValues615NegHel, ex, pSigmaErrValues615NegHel);
    gr20->Fit("LegendreFit");
    gr20->SetMarkerColor(4);
    gr20->SetLineColor(4);
    gr20->SetLineWidth(3);
    gr20->SetMarkerStyle(8);
    gr20->SetMarkerSize(1.5);
    gr20->SetTitle("#Sigma as fn of Cos#theta_{CM} (E_{#gamma} 610-620MeV)");
    gr20->GetXaxis()->SetTitle("Cos#theta_{CM}");
    gr20->GetYaxis()->SetTitle("#Sigma");
    gr20->SetName("Sigma615NegHel");
    gr20->Draw("epz");
    gr20a = new TGraphErrors(10, x, pSigmaValues615PosHel, ex, pSigmaErrValues615PosHel);
    gr20a->SetMarkerColor(2);
    gr20a->SetLineColor(2);
    gr20a->SetLineWidth(3);
    gr20a->SetMarkerStyle(24);
    gr20a->SetMarkerSize(1.5);
    gr20a->SetName("Sigma615PosHel");
    gr20a->Draw("epsamez");
    gr20b = new TGraphErrors(10, x, pSigmaValues615, ex, pSigmaErrValues615);
    gr20b->SetMarkerColor(1);
    gr20b->SetLineColor(1);
    gr20b->SetLineWidth(3);
    gr20b->SetMarkerStyle(33);
    gr20b->SetMarkerSize(2);
    gr20b->SetName("Sigma615");
    gr20b->Draw("epsamez");

    canvas->Write();
    gr1->Write();
    gr1a->Write();
    canvas1->Write();
    gr2->Write();
    gr2a->Write();
    canvas2->Write();
    gr3->Write();
    gr3a->Write();
    canvas3->Write();
    gr4->Write();
    gr4a->Write();
    canvas4->Write();
    gr5->Write();
    gr5a->Write();
    canvas5->Write();
    gr6->Write();
    gr6a->Write();
    canvas6->Write();
    gr7->Write();
    gr7a->Write();
    canvas7->Write();
    gr8->Write();
    gr8a->Write();
    canvas8->Write();
    gr9->Write();
    gr9a->Write();
    canvas9->Write();
    gr10->Write();
    gr10a->Write();
    canvas10->Write();
    gr11->Write();
    gr11a->Write();
    canvas11->Write();
    gr12->Write();
    gr12a->Write();
    canvas12->Write();
    gr13->Write();
    gr13a->Write();
    canvas13->Write();
    gr14->Write();
    gr14a->Write();
    canvas14->Write();
    gr15->Write();
    gr15a->Write();
    canvas15->Write();
    gr16->Write();
    gr16a->Write();
    canvas16->Write();
    gr17->Write();
    gr17a->Write();
    canvas17->Write();
    gr18->Write();
    gr18a->Write();
    canvas18->Write();
    gr19->Write();
    gr19a->Write();
    canvas19->Write();
    gr20->Write();
    gr20a->Write();

    TCanvas *canvas20 = new TCanvas("canvas20","canvas20", 1920, 1080);
    canvas20->Divide(5,4);
    canvas20->cd(1);
    pad1->Draw();
    canvas20->cd(2);
    pad2->Draw();
    canvas20->cd(3);
    pad3->Draw();
    canvas20->cd(4);
    pad4->Draw();
    canvas20->cd(5);
    pad5->Draw();
    canvas20->cd(6);
    pad6->Draw();
    canvas20->cd(7);
    pad7->Draw();
    canvas20->cd(8);
    pad8->Draw();
    canvas20->cd(9);
    pad9->Draw();
    canvas20->cd(10);
    pad10->Draw();
    canvas20->cd(11);
    pad11->Draw();
    canvas20->cd(12);
    pad12->Draw();
    canvas20->cd(13);
    pad13->Draw();
    canvas20->cd(14);
    pad14->Draw();
    canvas20->cd(15);
    pad15->Draw();
    canvas20->cd(16);
    pad16->Draw();
    canvas20->cd(17);
    pad17->Draw();
    canvas20->cd(18);
    pad18->Draw();
    canvas20->cd(19);
    pad19->Draw();
    canvas20->cd(20);
    pad20->Draw();

    canvas20->Write();

    TCanvas *canvas21 = new TCanvas("canvas21","canvas21", 1920, 1080);
    leg = new TLegend(0.0, 0.0, 0.6, 0.6);
    leg->AddEntry(gr2, "-ve Helicity", "ezp");
    leg->AddEntry(gr2a, "+ve Helicity", "pze");
    leg->AddEntry(gr2b, "Combined", "pze");
    leg->Draw();
    canvas21->Write();
    f3.Write();
}
